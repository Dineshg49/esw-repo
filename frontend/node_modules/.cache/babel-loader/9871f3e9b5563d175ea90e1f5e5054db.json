{"ast":null,"code":"var _jsxFileName = \"/home/kevin/Downloads/ESW/esw-repo/frontend/src/components/Common/stats.js\";\nimport React, { Component, auto } from 'react'; // import { BrowserRouter as Router, Route, Link } from \"react-router-dom\";\n\nimport \"bootstrap/dist/css/bootstrap.min.css\"; // import Button from '@mui/material/Button';\n\nimport Paper from '@mui/material/Paper';\nimport axios from 'axios';\nimport { FcCancel } from \"react-icons/fc\";\nimport { FcApproval } from \"react-icons/fc\";\nimport { color } from 'd3-color';\nimport { interpolateRgb } from 'd3-interpolate'; // import React, { Component } from 'react';\n\nimport ReactDOM from 'react-dom';\nimport LiquidFillGauge from 'react-liquid-gauge';\nimport { Toast } from 'bootstrap';\nconst styles = {\n  height: auto,\n  width: auto,\n  textAlign: 'center',\n  rounded: true,\n  paddingTop: auto,\n  backgroundColor: '#76D8E3',\n  opacity: 0.8,\n  margin: 10,\n  fontSize: 40\n};\nlet y = \"Average Monthly Water Usage: \";\nlet x = \"Average Daily Water Usage:  \";\nlet resultx = 0;\nlet level = 100;\nlet total = 200; // function hash(s, M) {\n//     let sum = 0, mul = 1;\n//     for (let i = 0; i < s.length; i++) {\n//     //   mul = (i % 4 == 0) ? 1 : mul * 256;\n//         console.log(sum);\n//         console.log(s.charCodeAt(i));\n//       sum += s.charAt(i) * mul;\n//       console.log(sum);\n//     }\n//     console.log(Math.abs(sum) % M);\n//     return (Math.abs(sum) % M);\n//   }\n\nlet decrypt = [{\n  'u': 0,\n  'x': 1,\n  'r': 2,\n  'p': 3,\n  'c': 4,\n  't': 5,\n  'z': 6,\n  'v': 7,\n  'd': 8,\n  'k': 9,\n  'h': -1\n}, {\n  'n': 0,\n  'h': 1,\n  'e': 2,\n  'u': 3,\n  'v': 4,\n  'y': 5,\n  'z': 6,\n  'a': 7,\n  'p': 8,\n  'x': 9,\n  'j': -1\n}, {\n  'g': 0,\n  's': 1,\n  'c': 2,\n  'a': 3,\n  'j': 4,\n  'i': 5,\n  'q': 6,\n  'v': 7,\n  'd': 8,\n  'f': 9,\n  'k': -1\n}];\n\nfunction hash(s, M) {\n  let sum = 0,\n      mul = 1;\n\n  for (let i = 0; i < s.length; i++) {\n    mul = i % 4 == 0 ? 1 : mul * 256;\n    sum += s.charCodeAt(i) * mul;\n  } // console.log(sum);\n\n\n  return Math.abs(sum) % M;\n}\n\nexport default class Home extends Component {\n  constructor(props) {\n    super(props); // this.logout = this.logout.bind(this);\n\n    this.startColor = '#6495ed';\n    this.endColor = '#dc143c';\n    this.state = {\n      level: 40,\n      value: level * 100 / total,\n      mstatus: \"Off\" //   x: \"Water level in tank: \"\n\n    };\n  }\n\n  // crimson\n  componentDidUpdate() {\n    function gettim(ts) {\n      var y = parseInt(ts[0] + ts[1] + ts[2] + ts[3]);\n      var m = parseInt(ts[4] + ts[5]);\n      var d = parseInt(ts[6] + ts[7]);\n      var h = parseInt(ts[9] + ts[10]);\n      var min = parseInt(ts[11] + ts[12]);\n      let ret = String(d) + \"/\" + String(m) + \"/\" + String(y) + \" \" + String(h) + \":\" + String(min);\n      return ret;\n    }\n\n    function interval(months, days, hours) {\n      var interva = months * 30 * 24 * 60 + days * 24 * 60 + hours * 60;\n      return interva;\n    }\n\n    function calc() {\n      var today = new Date();\n      var dd = today.getDate();\n      var mm = today.getMonth() + 1; //January is 0!\n\n      var yyyy = today.getFullYear();\n      var hh = today.getHours();\n      var curr_time = yyyy * 12 * 30 * 24 * 60 + mm * 30 * 24 * 60 + dd * 24 * 60 + hh * 60;\n      return curr_time;\n    }\n\n    function check(curr_time, ts, months, days, hours) {\n      var interval = months * 30 * 24 * 60 + days * 24 * 60 + hours * 60;\n      var y = parseInt(ts[0] + ts[1] + ts[2] + ts[3]);\n      var m = parseInt(ts[4] + ts[5]);\n      var d = parseInt(ts[6] + ts[7]);\n      var h = parseInt(ts[9] + ts[10]);\n      var min = parseInt(ts[11] + ts[12]);\n      var lt = y * 12 * 30 * 24 * 60 + m * 30 * 24 * 60 + d * 24 * 60 + h * 60 + min;\n\n      if (curr_time - lt > interval) {\n        return 0;\n      } else {\n        return 1;\n      }\n    }\n\n    function filter_data(sum, ts, months, days, hours) {\n      var total_minutes = months * 30 * 24 * 60 + days * 24 * 60 + hours * 60;\n      var today = new Date();\n      var dd = today.getDate();\n      var mm = today.getMonth() + 1; //January is 0!\n\n      var yyyy = today.getFullYear();\n      var hh = today.getHours();\n      var y = parseInt(ts[0] + ts[1] + ts[2] + ts[3]);\n      var m = parseInt(ts[4] + ts[5]);\n      var d = parseInt(ts[6] + ts[7]);\n      var h = parseInt(ts[9] + ts[10]);\n      var min = parseInt(ts[11] + ts[12]);\n      yyyy -= y;\n      mm -= m;\n      dd -= d;\n      hh -= h;\n      var minutes_passed = yyyy * 12 * 30 * 24 * 60 + mm * 30 * 24 * 60 + dd * 24 * 60 + hh * 60; // console.log(total_minutes,minutes_passed)\n\n      if (minutes_passed < total_minutes) {\n        let ret = String(d) + \"/\" + String(m) + \"/\" + String(y) + \" \" + String(h) + \":\" + String(min);\n        return ret;\n      } else {\n        return \"-1\";\n      }\n    }\n\n    axios.get('http://localhost:4000/testy', {}).then(res => {\n      let data2 = [];\n      let array = res.data[\"m2m:cnt\"][\"m2m:cin\"];\n      console.log(\"this\", array);\n      let sum = 0;\n      let curr_time = calc();\n      let grapharray = [];\n      let velocity_of_water = 5; //litres per minute\n\n      let interva = 1; // minutes\n\n      for (let i = array.length - 1; i > 0; i--) {\n        let data = array[i].con;\n        data = data.split(';');\n        let hboi = hash(data[0] + data[1], 23);\n        let lvl = 0;\n        lvl = parseInt(Number(\"0x\" + data[0]), 10);\n        let ts = array[i].ct;\n        let timev;\n        let flag = check(curr_time, ts, 0, 1, 0);\n\n        if (flag == 0) {\n          let timec = gettim(ts);\n          grapharray.push({\n            name: sum,\n            uv: timec\n          }); // push the time also \n\n          sum = 0;\n          curr_time -= interval(0, 1, 0);\n        }\n\n        let status_i = 0; // off\n\n        let status_i_minus_1 = 1; // on\n\n        if (status_i & status_i_minus_1) {\n          sum += velocity_of_water * interva;\n        } else if (status_i ^ status_i_minus_1) {\n          sum += velocity_of_water * interva / 2;\n        } // add the value of the current interval to the sum\n        // if(this.state.duration == \"1\")\n        //   timev = filter_data(sum,ts, parseInt(this.state.textFieldValue),0,0);\n        // if(this.state.duration == \"2\")\n        //   timev = filter_data(sum,ts, 0, parseInt(this.state.textFieldValue),0);\n        // if(this.state.duration == \"3\")\n        //   timev = filter_data(sum,ts, 0,0,parseInt(this.state.textFieldValue));\n        // let value = { name: timev, uv: lvl };\n        // if (timev !== \"-1\") {\n        //   data2.push(value);\n        // }\n\n      }\n\n      let avg = 0;\n\n      for (let i = 0; i < grapharray.length; i++) {\n        avg += grapharray[i].name;\n      }\n\n      avg /= grapharray.length;\n      this.data = data2;\n      this.setState({\n        data: data2\n      });\n    });\n  }\n\n  componentDidMount() {\n    axios.get('http://localhost:4000/test', {}).then(res => {\n      let data = res.data[\"m2m:cin\"].con;\n      console.log(res); // let data = \"/EF;2/\";\n      // console.log(data);\n      // data = data.substring(1, data.length-1);\n      // let data = array[i].con;\n\n      data = data.split(';');\n      let water = 0;\n      let motor = decrypt[data[3]][[data[1][0]]]; // motor = motor-1;\n\n      for (let i = 0; i < data[0].length; i++) if (decrypt[data[3]][[data[0][i]]] != -1) {\n        water = water * 10;\n        water = water + decrypt[data[3]][[data[0][i]]]; // console.log(decrypt[data[3]][[data[0][i]]]);\n        // console.log(data[0]);\n      }\n\n      console.log(\"got\", water.toString() + motor.toString());\n      let hboi = hash(water.toString() + motor.toString(), 50);\n      console.log(hboi, data);\n      if (hboi == data[2]) console.log(\"yee\");\n      this.setState({\n        level: water\n      }); // this.setState({motor})\n\n      console.log(\"x is \", this.state.level); // console.log(parseInt(Number(\"0x\"+data[0]), 10));\n      // console.log(this.x);\n\n      if (motor == 1) this.setState({\n        mstatus: \"Off\"\n      });else this.setState({\n        mstatus: \"On\"\n      }); // this.setState({x:\"hmm\"});\n      //   if(res.data==='Success')\n      //   {\n      //     // ReactDOM.render(<UserApp/>,document.getElementById(\"root\"));\n      //     // UserProfile.setName(email.value);\n      //     // const newSession = {\n      //     //   email: email.value\n      //     // }\n      //     // const newLink = {\n      //     //   pathname: \"/users/userprofile\",\n      //     //   name: email.value\n      //     // };\n      //     // ReactDOM.render(<Link to={newLink}> hi </Link>, document.getElementById(\"root\"));\n      //   }\n      //   else\n      //     alert( res.data);console.log(res.data);\n    });\n  }\n\n  render() {\n    const radius = 200;\n    const interpolate = interpolateRgb(this.startColor, this.endColor);\n    const fillColor = interpolate(this.state.value / 100);\n    const gradientStops = [{\n      key: '0%',\n      stopColor: color(fillColor).darker(0.5).toString(),\n      stopOpacity: 1,\n      offset: '0%'\n    }, {\n      key: '50%',\n      stopColor: fillColor,\n      stopOpacity: 0.75,\n      offset: '50%'\n    }, {\n      key: '100%',\n      stopColor: color(fillColor).brighter(0.5).toString(),\n      stopOpacity: 0.5,\n      offset: '100%'\n    }];\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318\n      },\n      __self: this\n    }, React.createElement(Paper, {\n      style: styles,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319\n      },\n      __self: this\n    }, \"Average Daily Water Usage: \", level, \"m\"), React.createElement(Paper, {\n      style: styles,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 322\n      },\n      __self: this\n    }, y));\n  }\n\n} // ReactDOM.render(<App />, document.querySelector('#app'));","map":{"version":3,"sources":["/home/kevin/Downloads/ESW/esw-repo/frontend/src/components/Common/stats.js"],"names":["React","Component","auto","Paper","axios","FcCancel","FcApproval","color","interpolateRgb","ReactDOM","LiquidFillGauge","Toast","styles","height","width","textAlign","rounded","paddingTop","backgroundColor","opacity","margin","fontSize","y","x","resultx","level","total","decrypt","hash","s","M","sum","mul","i","length","charCodeAt","Math","abs","Home","constructor","props","startColor","endColor","state","value","mstatus","componentDidUpdate","gettim","ts","parseInt","m","d","h","min","ret","String","interval","months","days","hours","interva","calc","today","Date","dd","getDate","mm","getMonth","yyyy","getFullYear","hh","getHours","curr_time","check","lt","filter_data","total_minutes","minutes_passed","get","then","res","data2","array","data","console","log","grapharray","velocity_of_water","con","split","hboi","lvl","Number","ct","timev","flag","timec","push","name","uv","status_i","status_i_minus_1","avg","setState","componentDidMount","water","motor","toString","render","radius","interpolate","fillColor","gradientStops","key","stopColor","darker","stopOpacity","offset","brighter"],"mappings":"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","sourcesContent":["import React, {Component, auto} from 'react';\n// import { BrowserRouter as Router, Route, Link } from \"react-router-dom\";\nimport \"bootstrap/dist/css/bootstrap.min.css\"\n// import Button from '@mui/material/Button';\nimport Paper from '@mui/material/Paper';\nimport axios from 'axios';\nimport { FcCancel } from \"react-icons/fc\";\nimport { FcApproval } from \"react-icons/fc\";\nimport { color } from 'd3-color';\nimport { interpolateRgb } from 'd3-interpolate';\n// import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport LiquidFillGauge from 'react-liquid-gauge';\nimport { Toast } from 'bootstrap';\n\nconst styles = {\n\theight: auto,\n  width: auto,\n  textAlign: 'center',\n  rounded: true,\n  paddingTop: auto,\n  backgroundColor: '#76D8E3',\n  opacity: 0.8,\n  margin: 10,\n  fontSize:40\n};\nlet y = \"Average Monthly Water Usage: \";\nlet x = \"Average Daily Water Usage:  \";\nlet resultx = 0;\nlet level = 100; \nlet total = 200; \n\n// function hash(s, M) {\n//     let sum = 0, mul = 1;\n//     for (let i = 0; i < s.length; i++) {\n//     //   mul = (i % 4 == 0) ? 1 : mul * 256;\n//         console.log(sum);\n//         console.log(s.charCodeAt(i));\n//       sum += s.charAt(i) * mul;\n//       console.log(sum);\n//     }\n//     console.log(Math.abs(sum) % M);\n//     return (Math.abs(sum) % M);\n//   }\n\nlet decrypt = [\n    {'u': 0, 'x': 1, 'r': 2, 'p': 3, 'c': 4, 't': 5, 'z': 6, 'v': 7, 'd': 8, 'k': 9, 'h': -1},\n    {'n': 0, 'h': 1, 'e': 2, 'u': 3, 'v': 4, 'y': 5, 'z': 6, 'a': 7, 'p': 8, 'x': 9, 'j': -1},\n    {'g': 0, 's': 1, 'c': 2, 'a': 3, 'j': 4, 'i': 5, 'q': 6, 'v': 7, 'd': 8, 'f': 9, 'k': -1}\n  ]\n\nfunction hash(s, M) {\n    let sum = 0, mul = 1;\n    for (let i = 0; i < s.length; i++) {\n      mul = (i % 4 == 0) ? 1 : mul * 256;\n      sum += s.charCodeAt(i) * mul;\n    }\n    // console.log(sum);\n    return (Math.abs(sum) % M);\n  }\n\nexport default class Home extends Component {\n    \n    constructor(props) {\n        super(props);\n        // this.logout = this.logout.bind(this);\n        this.state = {\n            level : 40,\n            value : level*100/total,\n            mstatus: \"Off\",\n          //   x: \"Water level in tank: \"\n          };\n    }\n    startColor = '#6495ed'; // cornflowerblue\n    endColor = '#dc143c'; // crimson\n\n    componentDidUpdate() {\n        function gettim(ts)\n        {\n          var y = parseInt(ts[0] + ts[1] + ts[2] + ts[3]);\n          var m = parseInt(ts[4] + ts[5]);\n          var d = parseInt(ts[6] + ts[7]);\n          var h= parseInt(ts[9] + ts[10]);\n          var min = parseInt(ts[11]+ ts[12]);\n    \n          let ret = String(d) + \"/\" + String(m) + \"/\" + String(y) + \" \" + String(h) + \":\" +String(min);\n          return ret;\n    \n        }\n        function interval(months,days,hours)\n        {\n          var interva = months*30*24*60 + days*24*60 + hours*60;\n          return interva;\n        }\n        function calc() {\n          var today = new Date();\n          var dd = today.getDate();\n          var mm = today.getMonth()+1  //January is 0!\n          var yyyy = today.getFullYear();\n          var hh =today.getHours();\n    \n          var curr_time = yyyy*12*30*24*60 + mm*30*24*60 + dd*24*60 + hh*60;\n          return curr_time;\n    \n    \n        }\n        function check(curr_time,ts, months,days,hours){\n          var interval = months*30*24*60 + days*24*60 + hours*60;\n          var y = parseInt(ts[0] + ts[1] + ts[2] + ts[3]);\n          var m = parseInt(ts[4] + ts[5]);\n          var d = parseInt(ts[6] + ts[7]);\n          var h= parseInt(ts[9] + ts[10]);\n          var min = parseInt(ts[11]+ ts[12]);\n    \n          var lt = y*12*30*24*60 + m*30*24*60 + d*24*60 + h*60 + min;\n    \n          if(curr_time-lt > interval)\n          {\n            return 0;\n          }\n          else\n          {\n            return 1;\n          }\n    \n    \n        }\n        function filter_data(sum,ts, months,days,hours) {\n    \n          var total_minutes  = months*30*24*60 + days*24*60 + hours*60;\n          var today = new Date();\n          var dd = today.getDate();\n          var mm = today.getMonth()+1  //January is 0!\n          var yyyy = today.getFullYear();\n          var hh =today.getHours();\n    \n    \n          var y = parseInt(ts[0] + ts[1] + ts[2] + ts[3]);\n          var m = parseInt(ts[4] + ts[5]);\n          var d = parseInt(ts[6] + ts[7]);\n          var h= parseInt(ts[9] + ts[10]);\n          var min = parseInt(ts[11]+ ts[12]);\n    \n          yyyy-=y;\n          mm-=m;\n          dd-=d;\n          hh-=h;\n    \n          var minutes_passed = yyyy*12*30*24*60 + mm*30*24*60 + dd*24*60 + hh*60;\n    \n          // console.log(total_minutes,minutes_passed)\n          if(minutes_passed < total_minutes)\n          {\n            let ret = String(d) + \"/\" + String(m) + \"/\" + String(y) + \" \" + String(h) + \":\" +String(min);\n            return ret;\n          }\n          else{\n            return \"-1\";\n          }\n        }\n    \n        axios.get('http://localhost:4000/testy', {\n        })\n          .then(res => {\n            let data2 = [];\n            let array = res.data[\"m2m:cnt\"][\"m2m:cin\"];\n    \n            console.log(\"this\",array);\n            let sum = 0;\n            let curr_time = calc();\n            let grapharray = [];\n            let velocity_of_water = 5; //litres per minute\n            let interva = 1 // minutes\n            for (let i = array.length-1; i > 0; i--) {\n              let data = array[i].con;\n              data = data.split(';');\n              let hboi = hash(data[0] + data[1], 23);\n              let lvl = 0;\n              lvl = parseInt(Number(\"0x\" + data[0]), 10);\n    \n              let ts = array[i].ct;\n              let timev;\n              let flag = check(curr_time,ts, 0,1,0);\n              if(flag == 0)\n              {\n                let timec = gettim(ts);\n                grapharray.push({name: sum, uv: timec }); // push the time also \n                sum = 0;\n                curr_time -= interval(0,1,0);\n              }\n              let status_i = 0; // off\n              let status_i_minus_1 = 1; // on\n    \n              if(status_i & status_i_minus_1)\n              {\n                sum+= velocity_of_water*interva;\n              }\n              else if(status_i ^ status_i_minus_1)\n              {\n                sum+= (velocity_of_water*interva)/2;\n              }\n    \n              // add the value of the current interval to the sum\n    \n              // if(this.state.duration == \"1\")\n              //   timev = filter_data(sum,ts, parseInt(this.state.textFieldValue),0,0);\n              // if(this.state.duration == \"2\")\n              //   timev = filter_data(sum,ts, 0, parseInt(this.state.textFieldValue),0);\n              // if(this.state.duration == \"3\")\n              //   timev = filter_data(sum,ts, 0,0,parseInt(this.state.textFieldValue));\n              // let value = { name: timev, uv: lvl };\n              // if (timev !== \"-1\") {\n              //   data2.push(value);\n              // }\n            }\n            let avg = 0;\n            for(let i=0;i<grapharray.length;i++)\n            {\n                avg+= grapharray[i].name;\n            }\n            avg/= grapharray.length;\n            this.data = data2;\n            this.setState({ data: data2 })\n          })\n          ;\n      }\n\n    componentDidMount() {\n\n      \n        axios.get('http://localhost:4000/test', {\n          })\n                    .then(res => {\n                        let data = res.data[\"m2m:cin\"].con;\n                        console.log(res);\n                        // let data = \"/EF;2/\";\n                        // console.log(data);\n                        // data = data.substring(1, data.length-1);\n                        // let data = array[i].con;\n                        data = data.split(';');\n                        let water = 0;\n                        let motor = decrypt[data[3]][[data[1][0]]];\n                        // motor = motor-1;\n                        for(let i=0; i<data[0].length; i++)\n                            if(decrypt[data[3]][[data[0][i]]] != -1)\n                            {\n                            water = water*10;\n                            water = water + decrypt[data[3]][[data[0][i]]]\n                            // console.log(decrypt[data[3]][[data[0][i]]]);\n                            // console.log(data[0]);\n                            }\n                        console.log(\"got\", water.toString() + motor.toString());\n                        let hboi = hash(water.toString() + motor.toString(), 50);\n                        console.log(hboi, data);\n                        if(hboi == data[2])\n                            console.log(\"yee\");\n                        \n                        this.setState({level: water});\n                        // this.setState({motor})\n                        console.log(\"x is \", this.state.level);\n                        // console.log(parseInt(Number(\"0x\"+data[0]), 10));\n                        // console.log(this.x);\n                        \n                        if(motor == 1)\n                            this.setState({mstatus: \"Off\"});\n                        else\n                            this.setState({mstatus: \"On\"});\n                        // this.setState({x:\"hmm\"});\n                        \n\n                    //   if(res.data==='Success')\n                    //   {\n                    //     // ReactDOM.render(<UserApp/>,document.getElementById(\"root\"));\n                    //     // UserProfile.setName(email.value);\n                    //     // const newSession = {\n                    //     //   email: email.value\n                    //     // }\n                    //     // const newLink = {\n                    //     //   pathname: \"/users/userprofile\",\n                    //     //   name: email.value\n                    //     // };\n                        \n                    //     // ReactDOM.render(<Link to={newLink}> hi </Link>, document.getElementById(\"root\"));\n                        \n                    //   }\n                    //   else\n                    //     alert( res.data);console.log(res.data);\n                    })\n                    ;\n        }\n\n\n    render() {\n      const radius = 200;\n        const interpolate = interpolateRgb(this.startColor, this.endColor);\n        const fillColor = interpolate(this.state.value / 100);\n        const gradientStops = [\n            {\n                key: '0%',\n                stopColor: color(fillColor).darker(0.5).toString(),\n                stopOpacity: 1,\n                offset: '0%'\n            },\n            {\n                key: '50%',\n                stopColor: fillColor,\n                stopOpacity: 0.75,\n                offset: '50%'\n            },\n            {\n                key: '100%',\n                stopColor: color(fillColor).brighter(0.5).toString(),\n                stopOpacity: 0.5,\n                offset: '100%'\n            }\n        ];\n        return (\n            <div>    \n\t\t\t\t<Paper style={styles}>\n\t\t\t\t\tAverage Daily Water Usage: {level}m\n\t\t\t\t</Paper>\n\t\t\t\t<Paper style={styles}>\n\t\t\t\t\t{y}\n\t\t\t\t</Paper>\n            </div>\n        )\n    }\n}\n\n// ReactDOM.render(<App />, document.querySelector('#app'));"]},"metadata":{},"sourceType":"module"}